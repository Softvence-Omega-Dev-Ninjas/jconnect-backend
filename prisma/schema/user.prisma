// /prisma/schema.prisma (FIXED User Model)

model User {
  id                   String    @id @default(uuid())
  full_name            String
  email_address        String    @unique
  country_code         String?
  phone_number         String?
  password             String
  is_terms_agreed      Boolean   @default(false)
  auth_provider        String    @default("email") // 'email', 'google', 'facebook'
  is_active            Boolean   @default(true)
  login_attempts       Int       @default(0)
  last_login_at        DateTime?
  created_at           DateTime  @default(now())
  updated_at           DateTime  @updatedAt
  password_reset_token String?
  token_expires_at     DateTime?
  role                 Role      @default(USER)

  profile Profile?

  // Relations:
  services        Service[] // Services created by this User (Creator)
  serviceRequests ServiceRequest[] // Fixed Services requested by this User (Buyer)

  // Custom Requests where User is the Buyer (Relation field renamed for clarity)
  customRequestsAsBuyer CustomServiceRequest[] @relation(name: "BuyerCustomRequests")

  // Custom Requests where User is the Target Creator (Field renamed to fix conflict)
  targetedCustomRequests CustomServiceRequest[] @relation(name: "TargetedCustomRequests")

  @@map("users")
}

enum Role {
  USER
  MODERATOR
  ADMIN
  SUPER_ADMIN
}
